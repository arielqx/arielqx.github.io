{"title":"Data Story","markdown":{"yaml":{"title":"Data Story","mainfont":"Calibri"},"headingText":"Premier League 21-22","containsRefs":false,"markdown":"\n\n\n## **Research Question:**\n\n> *\"How influential was the home advantage for the Big Six football clubs in the 21-22 premier league season?\"*\n\n## **About the Premier League**\n\n```{r, echo=FALSE}\n#| eval: TRUE\n#| out.width: \"70%\"\n#| fig-align: center\nknitr::include_graphics(\"logo.avif\")\n```\n\nThe Premier League is the highest tier of football matches in the English football league. A total of 20 top football teams will compete in this league, which takes place between August and May annually, for a total of 380 matches.\n\nThree points are awarded for a win, one point for a draw, and none are awarded for a loss. The champion emerges with the most points at the end of the season and wins the Premier League title.\n\nRead more on the Premier League's [official website](https://www.premierleague.com/premier-league-explained).\n\n## Big Six FCs\n\nOf the 20 football clubs that compete in the Premier League, there have been a dominance of six main football teams since the 2010s.\n\nThese six football clubs include *(in no particular order)*:\n\n| Team              | Number of Wins (since 2009) |\n|-------------------|-----------------------------|\n| Manchester United | 2                           |\n| Liverpool         | 1                           |\n| Arsenal           | 0                           |\n| Chelsea           | 2                           |\n| Manchester City   | 7                           |\n| Tottenham Hotspur | 0                           |\n\nMore information about why these clubs are the \"Big Six\" can be found [here.](https://www.sportingnews.com/ca/soccer/news/who-are-premier-league-big-six-top-english-clubs-nickname-explained/8onqxiy3jynf1qr8b8kt8aags)\n\n## Premier League 2021-2022\n\n```{r, echo=FALSE}\n#| eval: TRUE\n#| out.width: \"100%\"\n#| fig-align: center\nknitr::include_graphics(\"mancitywin.jpg\")\n```\n\nIn the Premier League season of 2021-2022, Manchester City football club clinched the championship once again, after winning the 2020-2021 season as well, clocking their 6th Premier League title.\n\n### The Data\n\nTwo sets of data \"soccer\" and \"weekly rank\" with the following variables:\n\n```{r, echo=FALSE, eval=TRUE}\nsoccer <- read.csv(\"soccer21-22.csv\")\nweeklyrank <- read.csv(\"weeklyrank.csv\")\nstr(soccer)\n```\n\n```{r, echo=FALSE, eval=TRUE}\nstr(weeklyrank)\n```\n\n| Variable | Significance         | Used For                                                          | Type | DF         |\n|------------|------------|-------------------------|------------|------------|\n| \\$HTHG   | Half Time Home Goals | Analysis of home advantage on half time result                    | INT  | soccer     |\n| \\$HTAG   | Half Time Away Goals | Analysis of home advantage on half time result                    | INT  | soccer     |\n| \\$HTR    | Half Time Result     | Analysis of home advantage on half time result                    | CHR  | soccer     |\n| \\$FTHG   | Full Time Home Goals | Analysis of home advantage on full time result                    | INT  | soccer     |\n| \\$FTAG   | Full Time Away Goals | Analysis of home advantage on full time result                    | INT  | soccer     |\n| \\$FTR    | Full Time Result     | Analysis of home advantage on full time result                    | CHR  | soccer     |\n| \\$Team   | Football Club Name   | Analysis of effect of home advantage on weekly ranking of each FC | CHR  | weeklyrank |\n| \\$Rank   | Ranking out of 20    | Analysis of effect of home advantage on weekly ranking of each FC | INT  | weeklyrank |\n| \\$Week   | Week Number          | Analysis of effect of home advantage on weekly ranking of each FC | INT  | weeklyrank |\n\n### **Creating a new data frame:**\n\nCreating a new data frame *(df)* by selecting columns *\"Date\", \"HomeTeam\", \"AwayTeam\", \"FTR\", \"FTHG\"* and *\"FTAG\"*.\n\n```{r, echo=FALSE, eval=TRUE}\nlibrary(tidyverse) \ndf <- select(soccer,\n             Date,               \n             FTR,              \n             HST,              \n             AST,              \n             HomeTeam,\n             AwayTeam) \nhead(df)\n```\n\n```{r, echo=TRUE, eval=TRUE}\n## Creating separate dataframes \nManUnited_df <- df[df$HomeTeam==\"Man United\",] \nLiverpool_df <- df[df$HomeTeam==\"Liverpool\",] \nArsenal_df <- df[df$HomeTeam==\"Arsenal\",] \nChelsea_df <- df[df$HomeTeam==\"Chelsea\",] \nManCity_df <- df[df$HomeTeam==\"Man City\",] \nTottenham_df <- df[df$HomeTeam==\"Tottenham\",]\n```\n\n### **Findings:**\n\n**Home Team vs Away Team wins for Big 6 Teams:**\n\n```{r, eval=TRUE, echo=TRUE}\nlibrary(ggplot2)\nlibrary(cowplot)\n\nfig1 <- ggplot(ManUnited_df, aes(x=Date, y=FTR))+geom_point(color=\"red2\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Man United\") \nfig2 <- ggplot(Liverpool_df, aes(x=Date, y=FTR))+geom_point(color=\"firebrick\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Liverpool\")\nfig3 <- ggplot(Arsenal_df, aes(x=Date, y=FTR))+geom_point(color=\"coral1\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Arsenal\") \nfig4 <- ggplot(Chelsea_df, aes(x=Date, y=FTR))+geom_point(color=\"blue\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Chelsea\") \nfig5 <- ggplot(ManCity_df, aes(x=Date, y=FTR))+geom_point(color=\"lightskyblue\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Man City\") \nfig6 <- ggplot(Tottenham_df, aes(x=Date, y=FTR))+geom_point(color=\"navyblue\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Tottenham\") \n```\n\n```{r, eval=TRUE, echo=FALSE}\nFinal_Results <- plot_grid(\n  fig1 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  fig2 + theme(legend.justification = c(1,0), axis.text.x = element_text(size = 3)), \n  fig3 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  fig4 + theme(legend.justification = c(1,0), axis.text.x = element_text(size =3\n)), \n  fig5 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)),\nfig6 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  align =\"v\", \n  axis =\"lr\", \n  nrow =3, \n  ncol =2, \n  labels = LETTERS[1:6], \n  rel_heights = c(40,50))\n\nggsave(\"Final.png\",Final_Results,width=10, height=8, units=\"in\")\n```\n\nFrom the findings, it is clear that from a glance, most of the time the home team will get a win when playing on home grounds. This is most prominent in the case of Liverpool, where out of 20 games, up to 16 games were Home Team wins, and the rest were draws.\n\n```{r, echo=FALSE}\n#| eval: TRUE\n#| out.width: \"70%\"\n#| fig-align: center\n#| caption: Home Team vs Away Team Wins\nknitr::include_graphics(\"Final.png\")\n```\n\nThe advantage could be constituted by the number of shots on target for the home teams on home grounds, considering how they may be used to playing with the specific environments on home ground.\n\nHence, looking at all six teams' shots on target when on home grounds as opposed to their opponents:\n\n```{r, eval=TRUE, echo=FALSE}\nline1 <- ggplot(ManUnited_df, aes(x=Date,group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+\n  labs(title=\"Man United Shots\", x=\"Date\",y=\"Shots on Target\")+ \n  scale_color_manual(name=\"Shots\", values=c(\"Home Shots on Target\" = \"red2\", \"Away Shots on Target\"=\"grey\")) + theme(axis.text.x=element_text(size=3))\n\nline2 <- ggplot(Liverpool_df, aes(x=Date,group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+ \n  labs(title=\"Liverpool Shots\", x=\"Date\",y=\"Shots on Target\")+ \n  scale_color_manual(name=\"Shots\",values=c(\"Home Shots on Target\" = \"firebrick\", \"Away Shots on Target\"=\"grey\"))+ theme(axis.text.x=element_text(size=3))\n\nline3 <- ggplot(Arsenal_df, aes(x=Date,group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+\n  labs(title=\"Arsenal Shots\", x=\"Date\",y=\"Shots on Target\")+ \n  scale_color_manual(name=\"Shots\",values=c(\"Home Shots on Target\" = \"coral1\", \"Away Shots on Target\"=\"grey\"))+ theme(axis.text.x=element_text(size=3))\n\nline4 <- ggplot(Chelsea_df, aes(x=Date, group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+\n  labs(title=\"Chelsea Shots\", x=\"Date\",y=\"Shots on Target\")+\n  scale_color_manual(name=\"Shots\",values=c(\"Home Shots on Target\" = \"blue\", \"Away Shots on Target\"=\"grey\"))+ theme(axis.text.x=element_text(size=3))\n\nline5 <- ggplot(ManCity_df, aes(x=Date,group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+\n  labs(title=\"Manchester City Shots\", x=\"Date\",y=\"Shots on Target\")+\n  scale_color_manual(name=\"Shots\",values=c(\"Home Shots on Target\" = \"lightskyblue\", \"Away Shots on Target\"=\"grey\"))+theme(axis.text.x=element_text(size=3))\n\nline6<- ggplot(Tottenham_df, aes(x=Date,group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+\n  labs(title=\"Tottenham Shots\", x=\"Date\",y=\"Shots on Target\")+\n  scale_color_manual(name=\"Shots\",values=c(\"Home Shots on Target\" = \"navyblue\", \"Away Shots on Target\"=\"grey\"))+theme(axis.text.x=element_text(size=3))\n \n```\n\n```{r, eval=TRUE, echo=FALSE}\nShots <- plot_grid(\n  line1 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  line2 + theme(legend.justification = c(1,0), axis.text.x = element_text(size = 3)), \n  line3 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  line4 + theme(legend.justification = c(1,0), axis.text.x = element_text(size =3\n)), \n  line5 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)),\nline6 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  align =\"v\", \n  axis =\"lr\", \n  nrow =3, \n  ncol =2, \n  labels = LETTERS[1:6], \n  rel_heights = c(40,50))\n\nggsave(\"Shots.png\",Shots,width=10, height=8, units=\"in\")\n```\n\n```{r, echo=FALSE}\n#| eval: TRUE\n#| out.width: \"70%\"\n#| fig-align: center\nknitr::include_graphics(\"Shots.png\")\n```\n\nFor all of the teams, the home team lines largely seem to be greater than that of the away teams. This is further highlighted for teams A to E, Manchester United, Liverpool, Arsenal, Chelsea and Manchester City, whose home shots on target seem to spike much more in matches against away teams, reaching highs that pull the difference apart. However, Tottenham is an exception, with the highest scores being held by the away teams, hitting up to 10 shots on target.\n\nOverall, it seems that the home advantage was indeed influential in helping team have more shots on target. ðŸ¤”\n\n**Weekly rankings of each team (H vs A vs D):**\n\nPlot the rankings of each team by week number (bar graph)\n\n```{r, echo=FALSE, eval=TRUE}\n##Creating separate df for each team's weekly rank \nrank <- select(weeklyrank,\n               Team,\n               Week,\n               Rank)\nhead(rank)\nManUnited_rank <- rank[rank$Team==\"Man United\",] \nLiverpool_rank <- rank[rank$Team==\"Liverpool\",] \nArsenal_rank <- rank[rank$Team==\"Arsenal\",] \nChelsea_rank <- rank[rank$Team==\"Chelsea\",] \nManCity_rank <- rank[rank$Team==\"Man City\",] \nTottenham_rank <- rank[rank$Team==\"Tottenham\",]\n```\n\n```{r, eval=TRUE, echo=FALSE}\n## Creating figures (for grid later)\nfig11 <- ggplot(ManUnited_rank, aes(x=Week, y=Rank))+geom_line(color=\"red2\") + labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Man United\") + xlim(1,38) + ylim(20,1)\n\nfig12 <- ggplot(Liverpool_rank, aes(x=Week, y=Rank))+ geom_line(color=\"firebrick\")+labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Liverpool\") + xlim(1,38) + ylim(20,1)\n\nfig13 <- ggplot(Arsenal_rank, aes(x=Week, y=Rank))+geom_line(color=\"coral1\") + labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Arsenal\") + xlim(1,38) + ylim(20,1) \n\nfig14 <- ggplot(Chelsea_rank, aes(x=Week, y=Rank))+geom_line(color=\"blue\") + labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Chelsea\") + xlim(1,38) + ylim(20,1)\n\nfig15 <- ggplot(ManCity_rank, aes(x=Week, y=Rank))+geom_line(color=\"lightskyblue\") + labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Man City\") + xlim(1,38) + ylim(20,1)\n\nfig16 <- ggplot(Tottenham_rank, aes(x=Week, y=Rank))+geom_line(color=\"navyblue\") + labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Tottenham\") + xlim(1,38) + ylim(20,1)\n```\n\n```{r, eval=TRUE, echo=FALSE}\n## Plotting the grid for line graphs \nlibrary(ggplot2)\nlibrary(cowplot)\nRankplot <- plot_grid(\n  fig11 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  fig12 + theme(legend.justification = c(1,0), axis.text.x = element_text(size = 3)), \n  fig13 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  fig14 + theme(legend.justification = c(1,0), axis.text.x = element_text(size =3\n)), \n  fig15 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)),\nfig16 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  align =\"v\", \n  axis =\"lr\", \n  nrow =3, \n  ncol =2, \n  labels = LETTERS[1:6], \n  rel_heights = c(40,50))\n\nggsave(\"Rankplot.png\",Rankplot,width=10, height=8, units=\"in\")\n```\n\n```{r, echo=FALSE}\n#| eval: TRUE\n#| out.width: \"70%\"\n#| fig-align: center\nknitr::include_graphics(\"Rankplot.png\")\n```\n\nFrom the above graph, we can see that most of the teams seem to stay largely at the top ranks for each week, especially teams like Liverpool, Chelsea, and Manchester United. Hence, we take a look at the proportion of games overall played on home ground for each of these three teams to compare:\n\n```{r}\nlibrary(DT)\n\nui <- fluidPage(\n  h2(\"The 21-22 Premier League Season\"),\n  DT::dataTableOutput(\"soccer\")\n)\n\nserver <- function(input, output) {\n  output$soccer = DT::renderDataTable({\n    soccer\n  })\n}\n\nshinyApp(ui, server)\n```\n\n## **Conclusion**\n\nAll in all, it is clear that most of the teams playing on home ground do have some advantage, and it does have significant contribution for the games, however there are exceptions such as for teams like Tottenham, and in such cases it is valuable to consider other variable factors affecting the gameplay of the teams involved.\n\nThanks for reading, and we look forward to our new champions from the ongoing 2022/2023 English Premier League!\n\nHead over to the \"App\" page for a fun game related to the analysis here!\n\n## **References:**\n\n| *Premier league competition format & history \\| premier league*. (n.d.). Retrieved 6 November 2023, from https://www.premierleague.com/premier-league-explained\n\n| *Premier League match data 2021-2022*. (2022, September 25). Kaggle. https://www.kaggle.com/datasets/evangower/premier-league-match-data\n\n| Rfordatascience. (n.d.). *GitHub - rfordatascience/tidytuesday: Official repo for the #tidytuesday project*. GitHub. https://github.com/rfordatascience/tidytuesday/\n\n| *Who are the Premier League 'big six'? Top English clubs & nickname explained*. (2021, August 13). https://www.sportingnews.com/ca/soccer/news/who-are-premier-league-big-six-top-english-clubs-nickname-explained/8onqxiy3jynf1qr8b8kt8aags\n","srcMarkdownNoYaml":"\n\n# Premier League 21-22\n\n## **Research Question:**\n\n> *\"How influential was the home advantage for the Big Six football clubs in the 21-22 premier league season?\"*\n\n## **About the Premier League**\n\n```{r, echo=FALSE}\n#| eval: TRUE\n#| out.width: \"70%\"\n#| fig-align: center\nknitr::include_graphics(\"logo.avif\")\n```\n\nThe Premier League is the highest tier of football matches in the English football league. A total of 20 top football teams will compete in this league, which takes place between August and May annually, for a total of 380 matches.\n\nThree points are awarded for a win, one point for a draw, and none are awarded for a loss. The champion emerges with the most points at the end of the season and wins the Premier League title.\n\nRead more on the Premier League's [official website](https://www.premierleague.com/premier-league-explained).\n\n## Big Six FCs\n\nOf the 20 football clubs that compete in the Premier League, there have been a dominance of six main football teams since the 2010s.\n\nThese six football clubs include *(in no particular order)*:\n\n| Team              | Number of Wins (since 2009) |\n|-------------------|-----------------------------|\n| Manchester United | 2                           |\n| Liverpool         | 1                           |\n| Arsenal           | 0                           |\n| Chelsea           | 2                           |\n| Manchester City   | 7                           |\n| Tottenham Hotspur | 0                           |\n\nMore information about why these clubs are the \"Big Six\" can be found [here.](https://www.sportingnews.com/ca/soccer/news/who-are-premier-league-big-six-top-english-clubs-nickname-explained/8onqxiy3jynf1qr8b8kt8aags)\n\n## Premier League 2021-2022\n\n```{r, echo=FALSE}\n#| eval: TRUE\n#| out.width: \"100%\"\n#| fig-align: center\nknitr::include_graphics(\"mancitywin.jpg\")\n```\n\nIn the Premier League season of 2021-2022, Manchester City football club clinched the championship once again, after winning the 2020-2021 season as well, clocking their 6th Premier League title.\n\n### The Data\n\nTwo sets of data \"soccer\" and \"weekly rank\" with the following variables:\n\n```{r, echo=FALSE, eval=TRUE}\nsoccer <- read.csv(\"soccer21-22.csv\")\nweeklyrank <- read.csv(\"weeklyrank.csv\")\nstr(soccer)\n```\n\n```{r, echo=FALSE, eval=TRUE}\nstr(weeklyrank)\n```\n\n| Variable | Significance         | Used For                                                          | Type | DF         |\n|------------|------------|-------------------------|------------|------------|\n| \\$HTHG   | Half Time Home Goals | Analysis of home advantage on half time result                    | INT  | soccer     |\n| \\$HTAG   | Half Time Away Goals | Analysis of home advantage on half time result                    | INT  | soccer     |\n| \\$HTR    | Half Time Result     | Analysis of home advantage on half time result                    | CHR  | soccer     |\n| \\$FTHG   | Full Time Home Goals | Analysis of home advantage on full time result                    | INT  | soccer     |\n| \\$FTAG   | Full Time Away Goals | Analysis of home advantage on full time result                    | INT  | soccer     |\n| \\$FTR    | Full Time Result     | Analysis of home advantage on full time result                    | CHR  | soccer     |\n| \\$Team   | Football Club Name   | Analysis of effect of home advantage on weekly ranking of each FC | CHR  | weeklyrank |\n| \\$Rank   | Ranking out of 20    | Analysis of effect of home advantage on weekly ranking of each FC | INT  | weeklyrank |\n| \\$Week   | Week Number          | Analysis of effect of home advantage on weekly ranking of each FC | INT  | weeklyrank |\n\n### **Creating a new data frame:**\n\nCreating a new data frame *(df)* by selecting columns *\"Date\", \"HomeTeam\", \"AwayTeam\", \"FTR\", \"FTHG\"* and *\"FTAG\"*.\n\n```{r, echo=FALSE, eval=TRUE}\nlibrary(tidyverse) \ndf <- select(soccer,\n             Date,               \n             FTR,              \n             HST,              \n             AST,              \n             HomeTeam,\n             AwayTeam) \nhead(df)\n```\n\n```{r, echo=TRUE, eval=TRUE}\n## Creating separate dataframes \nManUnited_df <- df[df$HomeTeam==\"Man United\",] \nLiverpool_df <- df[df$HomeTeam==\"Liverpool\",] \nArsenal_df <- df[df$HomeTeam==\"Arsenal\",] \nChelsea_df <- df[df$HomeTeam==\"Chelsea\",] \nManCity_df <- df[df$HomeTeam==\"Man City\",] \nTottenham_df <- df[df$HomeTeam==\"Tottenham\",]\n```\n\n### **Findings:**\n\n**Home Team vs Away Team wins for Big 6 Teams:**\n\n```{r, eval=TRUE, echo=TRUE}\nlibrary(ggplot2)\nlibrary(cowplot)\n\nfig1 <- ggplot(ManUnited_df, aes(x=Date, y=FTR))+geom_point(color=\"red2\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Man United\") \nfig2 <- ggplot(Liverpool_df, aes(x=Date, y=FTR))+geom_point(color=\"firebrick\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Liverpool\")\nfig3 <- ggplot(Arsenal_df, aes(x=Date, y=FTR))+geom_point(color=\"coral1\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Arsenal\") \nfig4 <- ggplot(Chelsea_df, aes(x=Date, y=FTR))+geom_point(color=\"blue\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Chelsea\") \nfig5 <- ggplot(ManCity_df, aes(x=Date, y=FTR))+geom_point(color=\"lightskyblue\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Man City\") \nfig6 <- ggplot(Tottenham_df, aes(x=Date, y=FTR))+geom_point(color=\"navyblue\") + labs(x=\"Dates\",y=\"Full Time Result\", title=\"Tottenham\") \n```\n\n```{r, eval=TRUE, echo=FALSE}\nFinal_Results <- plot_grid(\n  fig1 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  fig2 + theme(legend.justification = c(1,0), axis.text.x = element_text(size = 3)), \n  fig3 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  fig4 + theme(legend.justification = c(1,0), axis.text.x = element_text(size =3\n)), \n  fig5 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)),\nfig6 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  align =\"v\", \n  axis =\"lr\", \n  nrow =3, \n  ncol =2, \n  labels = LETTERS[1:6], \n  rel_heights = c(40,50))\n\nggsave(\"Final.png\",Final_Results,width=10, height=8, units=\"in\")\n```\n\nFrom the findings, it is clear that from a glance, most of the time the home team will get a win when playing on home grounds. This is most prominent in the case of Liverpool, where out of 20 games, up to 16 games were Home Team wins, and the rest were draws.\n\n```{r, echo=FALSE}\n#| eval: TRUE\n#| out.width: \"70%\"\n#| fig-align: center\n#| caption: Home Team vs Away Team Wins\nknitr::include_graphics(\"Final.png\")\n```\n\nThe advantage could be constituted by the number of shots on target for the home teams on home grounds, considering how they may be used to playing with the specific environments on home ground.\n\nHence, looking at all six teams' shots on target when on home grounds as opposed to their opponents:\n\n```{r, eval=TRUE, echo=FALSE}\nline1 <- ggplot(ManUnited_df, aes(x=Date,group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+\n  labs(title=\"Man United Shots\", x=\"Date\",y=\"Shots on Target\")+ \n  scale_color_manual(name=\"Shots\", values=c(\"Home Shots on Target\" = \"red2\", \"Away Shots on Target\"=\"grey\")) + theme(axis.text.x=element_text(size=3))\n\nline2 <- ggplot(Liverpool_df, aes(x=Date,group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+ \n  labs(title=\"Liverpool Shots\", x=\"Date\",y=\"Shots on Target\")+ \n  scale_color_manual(name=\"Shots\",values=c(\"Home Shots on Target\" = \"firebrick\", \"Away Shots on Target\"=\"grey\"))+ theme(axis.text.x=element_text(size=3))\n\nline3 <- ggplot(Arsenal_df, aes(x=Date,group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+\n  labs(title=\"Arsenal Shots\", x=\"Date\",y=\"Shots on Target\")+ \n  scale_color_manual(name=\"Shots\",values=c(\"Home Shots on Target\" = \"coral1\", \"Away Shots on Target\"=\"grey\"))+ theme(axis.text.x=element_text(size=3))\n\nline4 <- ggplot(Chelsea_df, aes(x=Date, group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+\n  labs(title=\"Chelsea Shots\", x=\"Date\",y=\"Shots on Target\")+\n  scale_color_manual(name=\"Shots\",values=c(\"Home Shots on Target\" = \"blue\", \"Away Shots on Target\"=\"grey\"))+ theme(axis.text.x=element_text(size=3))\n\nline5 <- ggplot(ManCity_df, aes(x=Date,group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+\n  labs(title=\"Manchester City Shots\", x=\"Date\",y=\"Shots on Target\")+\n  scale_color_manual(name=\"Shots\",values=c(\"Home Shots on Target\" = \"lightskyblue\", \"Away Shots on Target\"=\"grey\"))+theme(axis.text.x=element_text(size=3))\n\nline6<- ggplot(Tottenham_df, aes(x=Date,group=1)) + \n  geom_line(aes(y=HST, color=\"Home Shots on Target\")) + \n  geom_line(aes(y=AST,color=\"Away Shots on Target\"))+\n  labs(title=\"Tottenham Shots\", x=\"Date\",y=\"Shots on Target\")+\n  scale_color_manual(name=\"Shots\",values=c(\"Home Shots on Target\" = \"navyblue\", \"Away Shots on Target\"=\"grey\"))+theme(axis.text.x=element_text(size=3))\n \n```\n\n```{r, eval=TRUE, echo=FALSE}\nShots <- plot_grid(\n  line1 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  line2 + theme(legend.justification = c(1,0), axis.text.x = element_text(size = 3)), \n  line3 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  line4 + theme(legend.justification = c(1,0), axis.text.x = element_text(size =3\n)), \n  line5 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)),\nline6 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  align =\"v\", \n  axis =\"lr\", \n  nrow =3, \n  ncol =2, \n  labels = LETTERS[1:6], \n  rel_heights = c(40,50))\n\nggsave(\"Shots.png\",Shots,width=10, height=8, units=\"in\")\n```\n\n```{r, echo=FALSE}\n#| eval: TRUE\n#| out.width: \"70%\"\n#| fig-align: center\nknitr::include_graphics(\"Shots.png\")\n```\n\nFor all of the teams, the home team lines largely seem to be greater than that of the away teams. This is further highlighted for teams A to E, Manchester United, Liverpool, Arsenal, Chelsea and Manchester City, whose home shots on target seem to spike much more in matches against away teams, reaching highs that pull the difference apart. However, Tottenham is an exception, with the highest scores being held by the away teams, hitting up to 10 shots on target.\n\nOverall, it seems that the home advantage was indeed influential in helping team have more shots on target. ðŸ¤”\n\n**Weekly rankings of each team (H vs A vs D):**\n\nPlot the rankings of each team by week number (bar graph)\n\n```{r, echo=FALSE, eval=TRUE}\n##Creating separate df for each team's weekly rank \nrank <- select(weeklyrank,\n               Team,\n               Week,\n               Rank)\nhead(rank)\nManUnited_rank <- rank[rank$Team==\"Man United\",] \nLiverpool_rank <- rank[rank$Team==\"Liverpool\",] \nArsenal_rank <- rank[rank$Team==\"Arsenal\",] \nChelsea_rank <- rank[rank$Team==\"Chelsea\",] \nManCity_rank <- rank[rank$Team==\"Man City\",] \nTottenham_rank <- rank[rank$Team==\"Tottenham\",]\n```\n\n```{r, eval=TRUE, echo=FALSE}\n## Creating figures (for grid later)\nfig11 <- ggplot(ManUnited_rank, aes(x=Week, y=Rank))+geom_line(color=\"red2\") + labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Man United\") + xlim(1,38) + ylim(20,1)\n\nfig12 <- ggplot(Liverpool_rank, aes(x=Week, y=Rank))+ geom_line(color=\"firebrick\")+labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Liverpool\") + xlim(1,38) + ylim(20,1)\n\nfig13 <- ggplot(Arsenal_rank, aes(x=Week, y=Rank))+geom_line(color=\"coral1\") + labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Arsenal\") + xlim(1,38) + ylim(20,1) \n\nfig14 <- ggplot(Chelsea_rank, aes(x=Week, y=Rank))+geom_line(color=\"blue\") + labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Chelsea\") + xlim(1,38) + ylim(20,1)\n\nfig15 <- ggplot(ManCity_rank, aes(x=Week, y=Rank))+geom_line(color=\"lightskyblue\") + labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Man City\") + xlim(1,38) + ylim(20,1)\n\nfig16 <- ggplot(Tottenham_rank, aes(x=Week, y=Rank))+geom_line(color=\"navyblue\") + labs(x=\"Week No.(of 38)\",y=\"Rank No. (of 20)\", title=\"Tottenham\") + xlim(1,38) + ylim(20,1)\n```\n\n```{r, eval=TRUE, echo=FALSE}\n## Plotting the grid for line graphs \nlibrary(ggplot2)\nlibrary(cowplot)\nRankplot <- plot_grid(\n  fig11 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  fig12 + theme(legend.justification = c(1,0), axis.text.x = element_text(size = 3)), \n  fig13 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  fig14 + theme(legend.justification = c(1,0), axis.text.x = element_text(size =3\n)), \n  fig15 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)),\nfig16 + theme(legend.justification = c(0,1), axis.text.x = element_text(size = 3)), \n  align =\"v\", \n  axis =\"lr\", \n  nrow =3, \n  ncol =2, \n  labels = LETTERS[1:6], \n  rel_heights = c(40,50))\n\nggsave(\"Rankplot.png\",Rankplot,width=10, height=8, units=\"in\")\n```\n\n```{r, echo=FALSE}\n#| eval: TRUE\n#| out.width: \"70%\"\n#| fig-align: center\nknitr::include_graphics(\"Rankplot.png\")\n```\n\nFrom the above graph, we can see that most of the teams seem to stay largely at the top ranks for each week, especially teams like Liverpool, Chelsea, and Manchester United. Hence, we take a look at the proportion of games overall played on home ground for each of these three teams to compare:\n\n```{r}\nlibrary(DT)\n\nui <- fluidPage(\n  h2(\"The 21-22 Premier League Season\"),\n  DT::dataTableOutput(\"soccer\")\n)\n\nserver <- function(input, output) {\n  output$soccer = DT::renderDataTable({\n    soccer\n  })\n}\n\nshinyApp(ui, server)\n```\n\n## **Conclusion**\n\nAll in all, it is clear that most of the teams playing on home ground do have some advantage, and it does have significant contribution for the games, however there are exceptions such as for teams like Tottenham, and in such cases it is valuable to consider other variable factors affecting the gameplay of the teams involved.\n\nThanks for reading, and we look forward to our new champions from the ongoing 2022/2023 English Premier League!\n\nHead over to the \"App\" page for a fun game related to the analysis here!\n\n## **References:**\n\n| *Premier league competition format & history \\| premier league*. (n.d.). Retrieved 6 November 2023, from https://www.premierleague.com/premier-league-explained\n\n| *Premier League match data 2021-2022*. (2022, September 25). Kaggle. https://www.kaggle.com/datasets/evangower/premier-league-match-data\n\n| Rfordatascience. (n.d.). *GitHub - rfordatascience/tidytuesday: Official repo for the #tidytuesday project*. GitHub. https://github.com/rfordatascience/tidytuesday/\n\n| *Who are the Premier League 'big six'? Top English clubs & nickname explained*. (2021, August 13). https://www.sportingnews.com/ca/soccer/news/who-are-premier-league-big-six-top-english-clubs-nickname-explained/8onqxiy3jynf1qr8b8kt8aags\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"project.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","editor":"visual","theme":{"light":"pulse","dark":"vapor"},"fontsize":"1.0em","linestretch":1.7,"linkcolor":"darkorchid","title":"Data Story","mainfont":"Calibri"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}